https://run.devpost.com/
https://chatgpt.com/
http://customer.premise.equipment/login.htm
https://ai.google.dev/gemini-api/terms
https://policies.google.com/privacy?hl=en

timport time

def generate_user_review_with_retry(client, prompt, max_retries=5):
    model_primary = "gemini-2.5-flash"
    model_fallback = "gemini-2.5-flash-lite"

    for attempt in range(max_retries):
        try:
            # Try the primary model first
            response = client.models.generate_content(
                model=model_primary if attempt == 0 else model_fallback,
                contents=prompt,
            )
            review_text = getattr(response, 'text', str(response))
            logger.info("Successfully generated user review")
            return review_text

        except Exception as e:
            # Check if it is a 503 overload error
            if '503' in str(e):
                wait_time = 2 ** attempt  # exponential backoff: 1, 2, 4, 8, ...
                logger.warning(f"Model overloaded. Retrying in {wait_time}s... (Attempt {attempt+1}/{max_retries})")
                time.sleep(wait_time)
            else:
                logger.error(f"Failed to generate user review: {str(e)}")
                raise RuntimeError(f"Failed to generate review: {str(e)}")

    # After all retries fail
    logger.error("All retries failed. Could not generate user review.")
    return "⚠️ Unable to generate review at this time."
